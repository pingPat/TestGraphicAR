package com.example.testgraphic;

import java.util.ArrayList;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Paint;
import android.util.AttributeSet;
import android.view.View;

public class DrawSurfaceView extends View{

	Paint mPaint = new Paint();
	private Bitmap[] mSpots, mBlips;
	private Bitmap mRadar;
	private double screenWidth, screenHeight = 0d;
	private double OFFSET = 0d;
	Point me = new Point(-33.870932d, 151.204727d, "Me");
	
	public void setOffset(float offset) {
	    this.OFFSET = offset;
	}
	
	public DrawSurfaceView(Context context, AttributeSet set) {
	    super(context, set);
	    mPaint.setColor(Color.GREEN);
		mPaint.setTextSize(50);
		mPaint.setStrokeWidth(DpiUtils.getPxFromDpi(getContext(), 2));
		mPaint.setAntiAlias(true);

		mRadar = BitmapFactory.decodeResource(context.getResources(), R.drawable.radar);

		mSpots = new Bitmap[props.size()];
		for (int i = 0; i < mSpots.length; i++) 
		    mSpots[i] = BitmapFactory.decodeResource(context.getResources(), R.drawable.dot);

		mBlips = new Bitmap[props.size()];
		for (int i = 0; i < mBlips.length; i++)
		    mBlips[i] = BitmapFactory.decodeResource(context.getResources(), R.drawable.blip);
	}
	
	@Override
	protected void onSizeChanged(int w, int h, int oldw, int oldh) {
	    super.onSizeChanged(w, h, oldw, oldh);
	    screenWidth = (double) w;
	    screenHeight = (double) h;
	}
	
	public static ArrayList<Point> props = new ArrayList<Point>();
	static {
	    props.add(new Point(90d, 110.8000, "North Pole"));
	    props.add(new Point(-90d, -110.8000, "South Pole"));
	    props.add(new Point(-33.870932d, 151.8000, "East"));
	    props.add(new Point(-33.870932d, 150.8000, "West"));
	}
	
	@Override
	protected void onDraw(Canvas canvas) {

		for (int i = 0; i < mBlips.length; i++) {
			Bitmap blip = mBlips[i]; //we aren't drawing these yet
			Bitmap spot = mSpots[i];
			Point u = props.get(i);
			
			if (spot == null ||  blip == null)
				continue;
			
			int spotCentreX = spot.getWidth() / 2;
			int spotCentreY = spot.getHeight() / 2;
			
			u.x = (float)screenWidth/3 * (i) - spotCentreX;
			u.y = (float)screenHeight/2 + (50*i) - spotCentreY; 
			
			canvas.drawBitmap(spot, u.x, u.y, mPaint);
			canvas.drawText(u.description, u.x, u.y, mPaint);
		}
	}
	
}
